on: [push, pull_request]

jobs:
    visualpinball-engine-win:
      runs-on: windows-latest
      steps:
        - uses: actions/checkout@v2
        - uses: nuget/setup-nuget@v1
        - name: Build
          run: |
             nuget restore
             dotnet build -c Release
          shell: bash
        - name: Test
          run: |
             $HOME/.nuget/packages/nunit.consolerunner/3.11.1/tools/nunit3-console.exe VisualPinball.Engine.Test/.bin/Release/net472/VisualPinball.Engine.Test.dll
          shell: bash

    visualpinball-engine-osx:
      runs-on: macos-latest
      steps:
        - uses: actions/checkout@v2
        - uses: nuget/setup-nuget@v1
        - name: Build
          run: |
             nuget restore
             msbuild /p:Configuration=Release
        - name: Test
          run: |
             mono $HOME/.nuget/packages/nunit.consolerunner/3.11.1/tools/nunit3-console.exe VisualPinball.Engine.Test/.bin/Release/net472/VisualPinball.Engine.Test.dll

    visualpinball-engine-linux:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v2
        - uses: nuget/setup-nuget@v1
        - name: Build
          run: |
             nuget restore
             msbuild /p:Configuration=Release
        - name: Test
          run: |
             mono $HOME/.nuget/packages/nunit.consolerunner/3.11.1/tools/nunit3-console.exe VisualPinball.Engine.Test/.bin/Release/net472/VisualPinball.Engine.Test.dll
